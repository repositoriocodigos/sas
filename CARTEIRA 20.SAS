%LET DT_MIS_INI = '01MAR2013'D;
%LET DT_MIS_FIM = '31MAR2013'D;

PROC SQL;/* CARDS STATE20*/
	CREATE TABLE WORK.CD_20 AS
		SELECT A.C_P_ACCT_NBR AS CARTAO,
			A.C_P_CACS_STATE_CODE AS STATE,
			A.MIS_DATE AS MIS_DATE
		FROM BRDBCON.DRI_076_ECS_COLL_PRI_ED AS A
			WHERE A.MIS_DATE GE &DT_MIS_INI
				AND A.MIS_DATE LE &DT_MIS_FIM
				AND A.C_P_CACS_STATE_CODE IN ( "F20", "M20", "H20", "L20", "S20", "R20", "O20", "Y20", "Z20");
RUN;

PROC SQL;/* RETAIL STATE20 OBS: SEMPRE CL*/
	CREATE TABLE WORK.CB_20 AS
		SELECT

			A.ACCT_NUM AS CONTA,
			A.CACS_FUNCTION_CODE||CACS_STATE_NUMBER AS STATE,
			A.MIS_DATE AS MIS_DATE
		FROM NWBRRCON.DRI_076_R_CACS_EXT_PRI_DG3 AS A
			WHERE A.MIS_DATE GE &DT_MIS_INI
				AND A.MIS_DATE LE &DT_MIS_FIM
				AND A.ACCT_NUM LIKE "CL%"  
				AND A.LOCATION_CODE EQ "010101"
				AND A.CACS_FUNCTION_CODE||CACS_STATE_NUMBER IN ("F20", "M20", "H20", "L20", "S20", "R20", "O20", "Y20", "Z20");
RUN;

PROC SQL;/* FINANCIAL STATE20 OBS: SEMPRE CONTRATO*/
	CREATE TABLE WORK.CF_20 AS
		SELECT

			A.ACCT_NUM AS CONTA,
			A.CACS_FUNCTION_CODE||CACS_STATE_NUMBER AS STATE,
			A.MIS_DATE AS MIS_DATE
		FROM NWBRRCON.DRI_076_R_CACS_EXT_PRI_DG3 AS A
			WHERE A.MIS_DATE GE &DT_MIS_INI
				AND A.MIS_DATE LE &DT_MIS_FIM
				AND A.ACCT_NUM NOT LIKE "CL%"
				AND A.LOCATION_CODE EQ "010701"
				AND A.CACS_FUNCTION_CODE||CACS_STATE_NUMBER IN ("F20", "M20", "H20", "L20", "S20", "R20", "O20", "Y20", "Z20");
RUN;

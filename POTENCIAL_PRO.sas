PROC SQL;/*CACS - PROMESSAS*/
CREATE TABLE WORK.CACS AS SELECT DISTINCT DRI_076_R_CACS_CCH_DG3.PROMISE_AMT_1 FORMAT=20.6,
	 DRI_076_R_CACS_CCH_DG3.PROMISE_DATE_1 FORMAT=DATETIME20.,
	 BASE_POTENCIAL_012012.SALDO_NACC,
	 BASE_POTENCIAL_012012.CONTRATO 
 FROM WORK.BASE_POTENCIAL_012012 AS BASE_POTENCIAL_012012
	  INNER JOIN NWBRRCON.DRI_076_R_CACS_CCH_DG3 AS DRI_076_R_CACS_CCH_DG3 ON (BASE_POTENCIAL_012012.CONTRATO = DRI_076_R_CACS_CCH_DG3.ACCT_NUM)
 WHERE ( DRI_076_R_CACS_CCH_DG3.MIS_DATE >= '01Dec2011:0:0:0'dt 
   AND ( DRI_076_R_CACS_CCH_DG3.LOCATION_CODE = '010701' 
   AND ( DRI_076_R_CACS_CCH_DG3.COLLECTION_ACTIVITY_CODE IN ( 'OC' , 'IC' ) 
   AND ( DRI_076_R_CACS_CCH_DG3.PARTY_CONTACTED_CODE IN ( 'A' , 'Y' ) 
   AND ( DRI_076_R_CACS_CCH_DG3.PROMISE_AMT_1 > 0 
   AND DRI_076_R_CACS_CCH_DG3.PROMISE_DATE_1 NOT  IS NULL ) ) ) ) )
   ORDER BY DRI_076_R_CACS_CCH_DG3.PROMISE_DATE_1;
QUIT;